<!DOCTYPE html>
<html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Admin - Script Manager</title><style>*{box-sizing:border-box;margin:0}body{background:#0b0b0b;color:#eaeaea;font-family:'Courier New',monospace;padding:20px}.container{max-width:800px;margin:0 auto}h1{color:#00f2ea;border-left:4px solid #00f2ea;padding-left:15px;margin-bottom:30px}.admin-card{background:#111;border:1px solid #2a2a2a;border-radius:16px;padding:25px;margin-bottom:25px}h2{color:#00f2ea;margin-bottom:20px;font-size:1.3rem}label{display:block;margin:15px 0 5px;color:#aaa;font-size:.9rem}input,textarea,select{width:100%;padding:12px;background:#1a1a1a;border:1px solid #3a3a3a;color:#fff;border-radius:8px;font-family:inherit}input:focus,textarea:focus,select:focus{border-color:#00f2ea;outline:0}textarea{min-height:100px;font-size:.8rem}.checkbox-group{display:flex;align-items:center;gap:10px;margin:15px 0}.checkbox-group input{width:auto}.feature-tags{display:flex;flex-wrap:wrap;gap:10px;margin:15px 0}.feature-tag{background:#1a2a2a;color:#9cfff8;padding:5px 12px;border-radius:30px;font-size:.8rem;border:1px solid #00f2ea40;cursor:pointer}.feature-tag.selected{background:#00f2ea;color:#000;border-color:#00f2ea}button{background:#00f2ea;color:#000;border:0;padding:14px 25px;border-radius:50px;font-weight:700;cursor:pointer;font-size:1rem;margin-top:10px;width:100%}button:hover{background:#00d4cc}button.delete{background:#ff4444;color:#fff}button.delete:hover{background:#cc0000}.script-item{background:#1a1a1a;border-left:3px solid #00f2ea;padding:15px;margin:15px 0;border-radius:8px;display:flex;justify-content:space-between;align-items:center}.script-info h3{color:#00f2ea;margin-bottom:5px}.script-info p{color:#888;font-size:.8rem}.script-actions{display:flex;gap:10px}.script-actions button{width:auto;padding:8px 15px;margin:0;font-size:.8rem}.update-note{background:#1a2a3a;border:1px solid #00f2ea;border-radius:8px;padding:15px;margin:20px 0;color:#fff;font-size:.9rem;text-align:center}.update-note strong{color:#00f2ea}.key-system-selector{background:#1a2a2a;border-radius:8px;padding:15px;margin:15px 0}.key-option{display:flex;align-items:center;gap:10px;margin:10px 0;padding:10px;background:#0f1a1f;border-radius:8px;cursor:pointer}.key-option input[type="radio"]{width:auto;margin-right:10px}.key-option.selected{background:#00f2ea20;border:1px solid #00f2ea}.key-badge{padding:4px 12px;border-radius:30px;font-size:.8rem;font-weight:bold}.key-badge.keyless{background:#4a4a4a;color:#fff}.key-badge.key1{background:#00aa00;color:#fff}.key-badge.key2{background:#ffaa00;color:#000}.key-badge.key3{background:#ff4444;color:#fff}.linkvertise-config{background:#0f1a2a;border-radius:8px;padding:15px;margin:15px 0;border:1px solid #00f2ea40}.linkvertise-config h3{color:#00f2ea;font-size:1rem;margin-bottom:10px}.redirect-url-container{background:#1a2a2a;border-radius:8px;padding:15px;margin:15px 0;border:1px solid #00f2ea;display:none}.redirect-url-container h3{color:#00f2ea;font-size:1rem;margin-bottom:10px}</style></head><body><div class="container"><h1>ğŸ”§ Script Manager Admin</h1>

<!-- NOTE ABOUT MANUAL UPLOAD -->
<div class="update-note">
  <strong>ğŸ“Œ Note:</strong> After adding or deleting scripts, click <strong>"ğŸ“¤ Download Updated scripts.json"</strong><br>
  and upload the file to GitHub to update your live site.
</div>

<!-- LINKVERTISE SETTINGS -->
<div class="admin-card">
  <h2>ğŸ”— Linkvertise Settings</h2>
  <label>Linkvertise User ID</label>
  <input type="text" id="linkvertiseUserId" placeholder="e.g., 1446949" value="1446949" readonly>
  <label>Callback URL (auto-generated)</label>
  <input type="text" id="callbackUrl" value="https://linkvertise-callback-production.up.railway.app/callback" readonly>
  <p style="color:#aaa; font-size:0.8rem; margin-top:5px;">âœ… Your Railway backend is connected</p>
</div>

<div class="admin-card">
  <h2>ğŸ“ Add New Script</h2>
  
  <label>Script Name (with emoji if desired)</label>
  <input type="text" id="scriptName" placeholder="e.g., ğŸ”ª NEW GAME">

  <label>Loadstring Code</label>
  <textarea id="scriptCode" placeholder='loadstring(game:HttpGet("URL"))()'></textarea>

  <!-- BLURRED CHECKBOX WITH TOGGLE -->
  <div class="checkbox-group">
    <input type="checkbox" id="scriptBlurred" onchange="toggleRedirectUrlField()">
    <label style="margin:0">ğŸ”’ Require verification (blurred)</label>
  </div>

  <!-- REDIRECT URL FIELD - ONLY SHOWS WHEN BLURRED IS CHECKED -->
  <div id="redirectUrlContainer" class="redirect-url-container" style="display: none;">
    <h3>ğŸ”— Redirect Settings</h3>
    <label>Destination URL (after 5 seconds)</label>
    <input type="url" id="scriptRedirectUrl" placeholder="https://openinapp.link/xxx">
    <p style="color:#aaa; font-size:0.8rem; margin-top:8px;">â±ï¸ Users will see a 5-second timer then redirect here</p>
    <p style="color:#ffaa00; font-size:0.8rem;">ğŸ“Š Use OpeninApp links to track clicks!</p>
  </div>

  <!-- KEY SYSTEM SELECTOR -->
  <label>ğŸ”‘ Key System Type</label>
  <div class="key-system-selector">
    <div class="key-option" onclick="selectKeySystem('keyless')" id="keyless-option">
      <input type="radio" name="keySystem" value="keyless" checked> 
      <span class="key-badge keyless">ğŸ”“ KEYLESS</span>
      <span style="color:#aaa;">No key required</span>
    </div>
    <div class="key-option" onclick="selectKeySystem('key1')" id="key1-option">
      <input type="radio" name="keySystem" value="key1"> 
      <span class="key-badge key1">ğŸ”‘ 1 KEY</span>
      <span style="color:#aaa;">Single Linkvertise</span>
    </div>
    <div class="key-option" onclick="selectKeySystem('key2')" id="key2-option">
      <input type="radio" name="keySystem" value="key2"> 
      <span class="key-badge key2">ğŸ”‘ğŸ”‘ 2 KEYS</span>
      <span style="color:#aaa;">Two Linkvertise checkpoints</span>
    </div>
    <div class="key-option" onclick="selectKeySystem('key3')" id="key3-option">
      <input type="radio" name="keySystem" value="key3"> 
      <span class="key-badge key3">ğŸ”‘ğŸ”‘ğŸ”‘ 3 KEYS</span>
      <span style="color:#aaa;">Three Linkvertise checkpoints</span>
    </div>
  </div>

  <!-- LINKVERTISE LINKS (shown only if key system selected) -->
  <div id="linkvertiseLinks" style="display:none;">
    <div class="linkvertise-config">
      <h3>ğŸ”— Linkvertise Links (using User ID: 1446949)</h3>
      <div id="linkvertiseFields"></div>
      <p style="color:#aaa; font-size:0.8rem;">Example: https://link-to.net/1446949/123456/dynamic</p>
    </div>
  </div>

  <label>Features (click to select)</label>
  <div class="feature-tags" id="featureTags">
    <span class="feature-tag" data-feature="ğŸ® Bloxfruit">ğŸ® Bloxfruit</span>
    <span class="feature-tag" data-feature="ğŸ§  Brainrot">ğŸ§  Brainrot</span>
    <span class="feature-tag" data-feature="ğŸŒŠ Tsunami">ğŸŒŠ Tsunami</span>
    <span class="feature-tag" data-feature="âš”ï¸ Rivals">âš”ï¸ Rivals</span>
    <span class="feature-tag" data-feature="ğŸ”« Arsenal">ğŸ”« Arsenal</span>
    <span class="feature-tag" data-feature="ğŸŸ Fisch">ğŸŸ Fisch</span>
    <span class="feature-tag" data-feature="ğŸ¾ Adopt Me">ğŸ¾ Adopt Me</span>
    <span class="feature-tag" data-feature="ğŸŒ± Garden">ğŸŒ± Garden</span>
  </div>

  <button onclick="saveScript()">ğŸ’¾ Save Script (updates list)</button>
</div>

<div class="admin-card">
  <h2>ğŸ“‹ Current Scripts</h2>
  <div id="scriptsList">
    <p style="color:#666;">Loading scripts...</p>
  </div>
  <button onclick="exportJSON()" style="background:#00f2ea;margin-top:20px;">ğŸ“¤ Download Updated scripts.json</button>
</div></div>

<script>
// ==================== ANTI-DEBUG ====================
document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('keydown', e => {
  if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I') || 
      (e.ctrlKey && e.shiftKey && e.key === 'J') || (e.ctrlKey && e.key === 'U')) {
    e.preventDefault();
  }
});
setInterval(() => { debugger; }, 200);

// ==================== TOGGLE REDIRECT URL FIELD ====================
function toggleRedirectUrlField() {
  const blurredCheckbox = document.getElementById('scriptBlurred');
  const redirectContainer = document.getElementById('redirectUrlContainer');
  
  if (blurredCheckbox.checked) {
    redirectContainer.style.display = 'block';
  } else {
    redirectContainer.style.display = 'none';
    // Clear the field when hidden
    document.getElementById('scriptRedirectUrl').value = '';
  }
}

// ==================== ADMIN CODE ====================
let selectedFeatures = [];
let currentScripts = [];
let selectedKeySystem = 'keyless';
const LINKVERTISE_USER_ID = '1446949';
const CALLBACK_URL = 'https://linkvertise-callback-production.up.railway.app/callback';

// Load existing scripts
async function loadScripts() {
  try {
    const response = await fetch('scripts.json?t=' + Date.now());
    const data = await response.json();
    currentScripts = data.scripts || [];
    displayScripts();
  } catch (error) {
    console.error('Failed to load scripts:', error);
    document.getElementById('scriptsList').innerHTML = 
      '<p style="color: #ff4444;">âŒ No scripts.json found</p>';
  }
}

// Key system selector
function selectKeySystem(value) {
  selectedKeySystem = value;
  document.querySelectorAll('.key-option').forEach(opt => {
    opt.classList.remove('selected');
  });
  document.getElementById(value + '-option').classList.add('selected');
  document.querySelector(`input[name="keySystem"][value="${value}"]`).checked = true;
  
  // Show/hide Linkvertise fields
  const linkvertiseDiv = document.getElementById('linkvertiseLinks');
  const fieldsDiv = document.getElementById('linkvertiseFields');
  
  if (value !== 'keyless') {
    linkvertiseDiv.style.display = 'block';
    const numKeys = parseInt(value.replace('key', ''));
    let html = '';
    for (let i = 1; i <= numKeys; i++) {
      html += `
        <label>Key ${i} Linkvertise URL</label>
        <input type="url" id="key${i}Link" placeholder="https://link-to.net/1446949/123456/dynamic">
      `;
    }
    fieldsDiv.innerHTML = html;
  } else {
    linkvertiseDiv.style.display = 'none';
  }
}

// Feature tag selection
document.querySelectorAll('.feature-tag').forEach(tag => {
  tag.addEventListener('click', function() {
    this.classList.toggle('selected');
    const feature = this.dataset.feature;
    if (selectedFeatures.includes(feature)) {
      selectedFeatures = selectedFeatures.filter(f => f !== feature);
    } else {
      selectedFeatures.push(feature);
    }
  });
});

function saveScript() {
  const name = document.getElementById('scriptName').value;
  const code = document.getElementById('scriptCode').value;
  const blurred = document.getElementById('scriptBlurred').checked;
  const redirectUrl = document.getElementById('scriptRedirectUrl').value;
  
  if (!name || !code) {
    alert('Please fill in all fields');
    return;
  }
  
  // If blurred is checked, redirect URL is required
  if (blurred && !redirectUrl) {
    alert('Please enter a redirect URL for blurred scripts');
    return;
  }
  
  // Collect Linkvertise links if key system
  let keyLinks = [];
  if (selectedKeySystem !== 'keyless') {
    const numKeys = parseInt(selectedKeySystem.replace('key', ''));
    for (let i = 1; i <= numKeys; i++) {
      const link = document.getElementById(`key${i}Link`)?.value;
      if (!link) {
        alert(`Please enter Key ${i} Linkvertise URL`);
        return;
      }
      keyLinks.push(link);
    }
  }
  
  const newScript = {
    id: name.toLowerCase().replace(/[^a-z0-9]/g, '') + Date.now(),
    name: name,
    code: code,
    blurred: blurred,
    redirectUrl: redirectUrl, // This gets saved to scripts.json
    keySystem: selectedKeySystem,
    keyLinks: keyLinks,
    features: [...selectedFeatures]
  };
  
  currentScripts.push(newScript);
  
  // Clear form
  document.getElementById('scriptName').value = '';
  document.getElementById('scriptCode').value = '';
  document.getElementById('scriptBlurred').checked = false;
  document.getElementById('redirectUrlContainer').style.display = 'none';
  document.getElementById('scriptRedirectUrl').value = '';
  selectedFeatures = [];
  selectedKeySystem = 'keyless';
  document.querySelectorAll('.feature-tag').forEach(t => t.classList.remove('selected'));
  document.querySelectorAll('.key-option').forEach(opt => opt.classList.remove('selected'));
  document.getElementById('keyless-option').classList.add('selected');
  document.querySelector('input[name="keySystem"][value="keyless"]').checked = true;
  document.getElementById('linkvertiseLinks').style.display = 'none';
  
  displayScripts();
  alert('âœ… Script added to list! Click "Download Updated scripts.json" to save changes.');
}

function displayScripts() {
  const list = document.getElementById('scriptsList');
  if (currentScripts.length === 0) {
    list.innerHTML = '<p style="color: #666;">No scripts yet</p>';
    return;
  }
  
  list.innerHTML = currentScripts.map(script => {
    let keyDisplay = '';
    if (script.keySystem === 'keyless') keyDisplay = '<span class="key-badge keyless">ğŸ”“ KEYLESS</span>';
    else if (script.keySystem === 'key1') keyDisplay = '<span class="key-badge key1">ğŸ”‘ 1 KEY</span>';
    else if (script.keySystem === 'key2') keyDisplay = '<span class="key-badge key2">ğŸ”‘ğŸ”‘ 2 KEYS</span>';
    else if (script.keySystem === 'key3') keyDisplay = '<span class="key-badge key3">ğŸ”‘ğŸ”‘ğŸ”‘ 3 KEYS</span>';
    
    return `
    <div class="script-item">
      <div class="script-info">
        <h3>${script.name}</h3>
        <p>${script.code.substring(0, 50)}...</p>
        <p style="display:flex; gap:5px; align-items:center; flex-wrap:wrap;">
          ${script.blurred ? 'ğŸ”’ Requires verification' : 'âœ… Public'} | 
          Features: ${script.features?.length || 0} |
          ${keyDisplay}
          ${script.keyLinks ? ` | ğŸ“ ${script.keyLinks.length} Linkvertise links` : ''}
          ${script.redirectUrl ? ` | ğŸ”— Has redirect URL` : ''}
        </p>
      </div>
      <div class="script-actions">
        <button onclick="deleteScript('${script.id}')" class="delete">ğŸ—‘ï¸</button>
      </div>
    </div>
  `}).join('');
}

function deleteScript(id) {
  let password = prompt('Enter admin password to delete:');
  if (password !== 'noobie123admin') {
    alert('Invalid password!');
    return;
  }
  
  if (confirm('Delete this script?')) {
    currentScripts = currentScripts.filter(script => script.id !== id);
    displayScripts();
    alert('âœ… Script removed from list! Click "Download Updated scripts.json" to save changes.');
  }
}

function exportJSON() {
  const data = {
    siteTitle: "lokus hub scripts",
    visitorCount: 1842,
    linkvertise: {
      userId: LINKVERTISE_USER_ID,
      callbackUrl: CALLBACK_URL
    },
    scripts: currentScripts,
    lastUpdated: new Date().toISOString().split('T')[0]
  };
  
  const jsonStr = JSON.stringify(data, null, 2);
  const blob = new Blob([jsonStr], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'scripts.json';
  a.click();
  URL.revokeObjectURL(url);
  
  alert('âœ… scripts.json downloaded! Upload this file to GitHub to update your live site.');
}

// Load scripts on page load
loadScripts();
</script></body></html>
