<!DOCTYPE html>
<html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>lokus hub scripts</title><style>
*{box-sizing:border-box;margin:0}body{background:#0b0b0b;color:#eaeaea;font-family:'Courier New',monospace;padding:20px;transition:all .3s ease}.container{max-width:1200px;margin:0 auto}h1{font-size:2rem;color:#00f2ea;border-left:4px solid #00f2ea;padding-left:20px;margin-bottom:30px}.subhead{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding-bottom:15px;border-bottom:1px solid #2a2a2a}.stats{display:flex;gap:15px;flex-wrap:wrap}.stat-badge{background:#1a1a2e;border:1px solid #00f2ea40;border-radius:40px;padding:10px 20px;font-size:.9rem;color:#00f2ea}.live-counter{background:#00f2ea20 !important;border-color:#00f2ea !important;display:inline-flex;align-items:center;gap:6px}.live-dot{width:10px;height:10px;background:#00f2ea;border-radius:50%;display:inline-block;animation:pulse 2s infinite}@keyframes pulse{0%{opacity:1;transform:scale(1)}50%{opacity:0.5;transform:scale(1.2)}100%{opacity:1;transform:scale(1)}}.music-btn{background:#1a1a1a;border:1px solid #2e2e2e;border-radius:40px;padding:10px 20px;cursor:pointer;color:#00f2ea}.music-btn.playing{animation:pulse 2s infinite}.discord-card{background:linear-gradient(145deg,#1a1f2e,#0f1219);border:2px solid #5865F2;border-radius:24px;padding:25px;margin:30px 0;display:flex;justify-content:space-between;align-items:center;cursor:pointer}.discord-left{display:flex;align-items:center;gap:20px}.discord-icon{font-size:3rem;background:#5865F2;width:70px;height:70px;border-radius:35px;display:flex;align-items:center;justify-content:center;color:white}.discord-right{display:flex;gap:30px}.stat-box{text-align:center}.stat-number{font-size:2rem;font-weight:bold;color:#00f2ea}.stat-label{font-size:.8rem;color:#8895c7}.scripts-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin:30px 0}@media (max-width:900px){.scripts-grid{grid-template-columns:repeat(2,1fr)}}@media (max-width:600px){.scripts-grid{grid-template-columns:1fr}}.script-card{background:#111;border:1px solid #242424;border-radius:16px;padding:20px;transition:all .2s;display:flex;flex-direction:column;position:relative}.script-card:hover{transform:translateY(-5px);box-shadow:0 10px 20px rgba(0,242,234,0.1)}.script-header{display:flex;align-items:center;gap:12px;margin-bottom:15px;position:relative;z-index:2}.script-icon{width:50px;height:50px;border-radius:12px;object-fit:cover;border:2px solid #00f2ea40}.script-title{font-size:1.1rem;color:#00f2ea;font-weight:bold;flex:1}.script-description{color:#aaa;font-size:.8rem;margin-bottom:15px;line-height:1.5;position:relative;z-index:2}.feature-tags{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:15px;position:relative;z-index:2}.feature-tag{background:#1a2a2a;color:#9cfff8;padding:4px 12px;border-radius:30px;font-size:.7rem;border:1px solid #00f2ea40}.key-badge{display:inline-block;padding:4px 12px;border-radius:30px;font-size:.7rem;font-weight:bold;margin-bottom:10px;position:relative;z-index:2}.key-badge.keyless{background:#4a4a4a;color:#fff}.key-badge.key1{background:#00aa00;color:#fff}.key-badge.key2{background:#ffaa00;color:#000}.key-badge.key3{background:#ff4444;color:#fff}.script-code{background:#0c0c0c;padding:15px;border-radius:12px;font-size:.75rem;color:#c5fffb;border:1px solid #2e2e2e;margin:15px 0;overflow-x:auto;white-space:pre-wrap;word-break:break-all;transition:all .2s}.copy-btn{background:#00f2ea;border:none;color:#000;padding:12px;border-radius:50px;font-weight:bold;cursor:pointer;width:100%;margin-top:auto;transition:all .2s;z-index:5;position:relative}.copy-btn:hover{background:#00d4cc}.copy-btn:disabled{opacity:0.3;cursor:not-allowed;pointer-events:none}.version-badge{background:#ffaa00;color:#000;padding:2px 8px;border-radius:30px;font-size:.6rem;margin-left:8px;font-weight:bold}.faq-section{background:#111;border-radius:20px;padding:25px;margin:40px 0}.faq-item{margin-bottom:20px}.faq-question{font-weight:bold;color:#fff;margin-bottom:8px;display:flex;align-items:center;gap:8px}.faq-question:before{content:"â“";color:#00f2ea}.faq-answer{color:#aaa;padding-left:28px}.social-grid{display:flex;flex-direction:column;gap:12px;margin:20px 0}.social-link{background:#111;padding:15px;border-radius:50px;text-align:center;color:#eaeaea;text-decoration:none;border:1px solid #2c2c2c}.social-link:hover{background:#1f1f1f;border-color:#00f2ea}.note{margin-top:40px;font-size:.7rem;color:#5f5f5f;text-align:center}.blurred{position:relative}.blurred .script-code{filter:blur(5px);pointer-events:none;user-select:none;opacity:0.7}.blurred .copy-btn{opacity:0.3;pointer-events:none;background:#4a4a4a;color:#888}.blurred::after{content:"ğŸ”’ VERIFY TO UNLOCK";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#00f2ea;color:#000;padding:16px 28px;border-radius:50px;font-weight:bold;font-size:1.1rem;z-index:20;border:2px solid #4afff0;box-shadow:0 0 20px #00f2ea;animation:glow 1.5s infinite;cursor:pointer;pointer-events:auto;white-space:nowrap;text-align:center}@keyframes glow{0%{box-shadow:0 0 10px #00f2ea}50%{box-shadow:0 0 25px #00f2ea}100%{box-shadow:0 0 10px #00f2ea}}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.95);backdrop-filter:blur(10px);display:none;justify-content:center;align-items:center;z-index:1000;padding:16px}.modal-overlay.active{display:flex}.modal-content{background:#111;border:2px solid #00f2ea;border-radius:32px;padding:32px 24px;max-width:400px;width:100%;text-align:center;box-shadow:0 0 40px #00f2ea33;animation:modalPop .3s ease}@keyframes modalPop{0%{transform:scale(.9);opacity:0}100%{transform:scale(1);opacity:1}}.modal-icon{font-size:56px;margin-bottom:16px}.modal-title{font-size:24px;font-weight:700;color:#00f2ea;margin-bottom:16px}.modal-text{color:#ccc;margin-bottom:24px;line-height:1.5}.redirect-timer{font-size:24px;color:#00f2ea;margin:20px 0;font-weight:bold}.timer-bar{width:100%;height:8px;background:#333;border-radius:10px;overflow:hidden;margin:16px 0}.timer-progress{height:100%;background:#00f2ea;width:100%;transition:width 1s linear}.modal-close{margin-top:20px;color:#888;cursor:pointer;font-size:14px}.modal-close:hover{color:#00f2ea}.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:#00f2ea;color:#000;padding:12px 30px;border-radius:50px;font-weight:bold;z-index:9999;display:none;box-shadow:0 5px 20px #00f2ea66}.toast.show{display:block;animation:slideUp .3s,fadeOut .3s 2s forwards}@keyframes slideUp{from{bottom:-50px}to{bottom:30px}}@keyframes fadeOut{to{opacity:0}}

/* Advanced Search Styles */
.search-container{background:#111;border-radius:16px;padding:25px;margin:30px 0 20px;border:2px solid #00f2ea40}.search-input-wrapper{position:relative;margin-bottom:20px}.search-input{width:100%;padding:18px 20px;background:#1a1a1a;border:2px solid #00f2ea40;border-radius:60px;color:#fff;font-size:1rem;outline:none;transition:all .3s;padding-right:120px}.search-input:focus{border-color:#00f2ea;box-shadow:0 0 20px #00f2ea66}.search-clear{position:absolute;right:15px;top:50%;transform:translateY(-50%);background:none;border:none;color:#888;cursor:pointer;font-size:1.2rem;padding:5px 10px;display:none}.search-clear:hover{color:#00f2ea}.filter-section{display:flex;gap:15px;flex-wrap:wrap;margin-bottom:20px}.filter-group{flex:1;min-width:150px}.filter-label{display:block;color:#aaa;font-size:.7rem;text-transform:uppercase;margin-bottom:5px}.filter-select{width:100%;padding:12px;background:#1a1a1a;border:2px solid #00f2ea40;border-radius:30px;color:#fff;font-size:.9rem;outline:none;cursor:pointer}.filter-select:hover{border-color:#00f2ea}.filter-chips{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}.filter-chip{padding:8px 16px;background:#1a1a1a;border:1px solid #00f2ea40;border-radius:30px;font-size:.8rem;cursor:pointer;transition:all .2s}.filter-chip:hover{background:#2a2a2a;border-color:#00f2ea}.filter-chip.active{background:#00f2ea;color:#000;border-color:#00f2ea}.search-stats{display:flex;justify-content:space-between;align-items:center;color:#888;font-size:.8rem;padding-top:15px;border-top:1px solid #2a2a2a}.search-reset{background:#00f2ea;color:#000;border:none;padding:8px 20px;border-radius:30px;font-size:.8rem;cursor:pointer;transition:all .2s}.search-reset:hover{background:#00d4cc;transform:scale(1.05)}
</style></head><body>
<div class="container">
  <h1 id="typingTitle">lokus hub scripts</h1>
  
  <!-- VERSION DISPLAY -->
  <div id="versionDisplay" style="text-align:right; margin-bottom:10px; color:#ffaa00;"></div>
  
  <div class="subhead">
    <div class="stats">
      <span class="stat-badge">ğŸ‘ï¸ <span id="visitorCount">0</span> today</span>
      <span class="stat-badge">ğŸ“Š <span id="totalVisits">0</span> total</span>
      <!-- WORKING LIVE COUNTER -->
      <span class="stat-badge live-counter" id="liveCounter">
        <span class="live-dot"></span>
        <span id="liveCount">1</span> online now
      </span>
    </div>
    <span class="music-btn" id="musicIndicator" onclick="toggleMusic()">ğŸ”Š music</span>
  </div>

  <audio id="bg-music" loop><source src="https://files.catbox.moe/71lr1s.mp3"></audio>

  <!-- DISCORD CARD -->
  <div class="discord-card" onclick="window.open('https://dsc.gg/lokus-hub', '_blank')">
    <div class="discord-left">
      <div class="discord-icon">ğŸ’¬</div>
      <div>
        <h3 style="color:white;">Join Discord</h3>
        <p style="color:#aab8e0;" id="discordServerName">lokus hub community</p>
      </div>
    </div>
    <div class="discord-right">
      <div class="stat-box">
        <div class="stat-number" id="onlineCount">--</div>
        <div class="stat-label">ONLINE</div>
      </div>
    </div>
  </div>

  <!-- ADVANCED SEARCH SECTION -->
  <div class="search-container">
    <div class="search-input-wrapper">
      <input type="text" class="search-input" id="searchInput" placeholder="ğŸ” Search scripts by name, description, or features..." autocomplete="off">
      <button class="search-clear" id="searchClear" onclick="clearSearch()">âœ•</button>
    </div>
    
    <div class="filter-section">
      <div class="filter-group">
        <div class="filter-label">ğŸ“ Game</div>
        <select class="filter-select" id="gameFilter" onchange="applyFilters()">
          <option value="all">All Games</option>
          <option value="mm2">ğŸ”ª Murder Mystery 2</option>
          <option value="adopt">ğŸ¾ Adopt Me</option>
          <option value="bloxfruit">ğŸ® Blox Fruits</option>
          <option value="fisch">ğŸŸ Fisch</option>
          <option value="arsenal">ğŸ”« Arsenal</option>
        </select>
      </div>
      
      <div class="filter-group">
        <div class="filter-label">ğŸ”‘ Key Type</div>
        <select class="filter-select" id="keyFilter" onchange="applyFilters()">
          <option value="all">All Keys</option>
          <option value="keyless">ğŸ”“ Keyless</option>
          <option value="key1">ğŸ”‘ 1 Key</option>
          <option value="key2">ğŸ”‘ğŸ”‘ 2 Keys</option>
          <option value="key3">ğŸ”‘ğŸ”‘ğŸ”‘ 3 Keys</option>
        </select>
      </div>
      
      <div class="filter-group">
        <div class="filter-label">âš¡ Features</div>
        <select class="filter-select" id="featureFilter" onchange="applyFilters()">
          <option value="all">All Features</option>
          <option value="aimbot">ğŸ¯ Aimbot</option>
          <option value="esp">ğŸ‘ï¸ ESP</option>
          <option value="farm">ğŸŒ¾ Auto Farm</option>
          <option value="teleport">ğŸŒ€ Teleport</option>
          <option value="speed">âš¡ Speed</option>
        </select>
      </div>
    </div>
    
    <div class="filter-chips" id="filterChips">
      <span class="filter-chip active" data-filter="all" onclick="setCategory('all')">ğŸ“‹ All</span>
      <span class="filter-chip" data-filter="mm2" onclick="setCategory('mm2')">ğŸ”ª MM2</span>
      <span class="filter-chip" data-filter="adopt" onclick="setCategory('adopt')">ğŸ¾ Adopt Me</span>
      <span class="filter-chip" data-filter="bloxfruit" onclick="setCategory('bloxfruit')">ğŸ® Blox Fruits</span>
      <span class="filter-chip" data-filter="popular" onclick="setCategory('popular')">ğŸ”¥ Popular</span>
      <span class="filter-chip" data-filter="new" onclick="setCategory('new')">âœ¨ New</span>
    </div>
    
    <div class="search-stats">
      <span><span id="visibleCount">0</span> of <span id="totalCount">0</span> scripts</span>
      <button class="search-reset" onclick="resetSearch()">âŸ² Reset Filters</button>
    </div>
  </div>

  <!-- SCRIPTS GRID -->
  <div class="scripts-grid" id="scriptsContainer">
    <p style="color:#666; text-align:center; grid-column:1/-1;">Loading scripts...</p>
  </div>

  <!-- FAQ SECTION -->
  <div class="faq-section">
    <h3 style="color:#00f2ea; margin-bottom:20px;">â“ Frequently Asked Questions</h3>
    <div class="faq-item">
      <div class="faq-question">How do I use these scripts?</div>
      <div class="faq-answer">Copy and paste into your Roblox executor</div>
    </div>
    <div class="faq-item">
      <div class="faq-question">Are these scripts safe?</div>
      <div class="faq-answer">Yes, all scripts are tested</div>
    </div>
  </div>

  <!-- SOCIALS -->
  <div class="social-grid">
    <a href="https://dsc.gg/lokus-hub" class="social-link">ğŸ’¬ discord</a>
    <a href="https://www.tiktok.com/@growagardenxaweso" class="social-link">ğŸµ tiktok</a>
    <a href="https://www.youtube.com/@drippyguygaming" class="social-link">â–¶ï¸ youtube</a>
  </div>

  <div class="note">âœ¦ lokus hub scripts â€” updated daily âœ¦</div>
</div>

<!-- REDIRECT MODAL -->
<div class="modal-overlay" id="redirectModal" onclick="closeRedirectModalIfOverlay(event)">
  <div class="modal-content">
    <div class="modal-icon">â³</div>
    <div class="modal-title">Verification Required</div>
    <div class="modal-text" id="redirectModalText">Please wait 5 seconds to continue...</div>
    <div class="redirect-timer" id="redirectTimer">5</div>
    <div class="timer-bar">
      <div class="timer-progress" id="redirectProgress" style="width:100%"></div>
    </div>
    <div class="modal-close" onclick="closeRedirectModal()">âœ• Cancel</div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="copyToast">ğŸ“‹ Script copied!</div>

<script>
// ==================== WORKING VISITOR COUNTER ====================
let visitorId = localStorage.getItem('visitorId');
if (!visitorId) {
  visitorId = 'visitor_' + Math.random().toString(36).substring(2) + '_' + Date.now();
  localStorage.setItem('visitorId', visitorId);
}

let onlineUsers = JSON.parse(localStorage.getItem('onlineUsers') || '{}');
let now = Date.now();

for (let id in onlineUsers) {
  if (now - onlineUsers[id] > 120000) {
    delete onlineUsers[id];
  }
}

onlineUsers[visitorId] = now;
localStorage.setItem('onlineUsers', JSON.stringify(onlineUsers));
document.getElementById('liveCount').textContent = Object.keys(onlineUsers).length;

setInterval(() => {
  let onlineUsers = JSON.parse(localStorage.getItem('onlineUsers') || '{}');
  let now = Date.now();
  
  for (let id in onlineUsers) {
    if (now - onlineUsers[id] > 120000) {
      delete onlineUsers[id];
    }
  }
  
  onlineUsers[visitorId] = now;
  localStorage.setItem('onlineUsers', JSON.stringify(onlineUsers));
  document.getElementById('liveCount').textContent = Object.keys(onlineUsers).length;
}, 30000);

// ==================== VISITOR COUNTER (daily/total) ====================
let totalVisits = localStorage.getItem('totalVisits') || 0;
totalVisits = parseInt(totalVisits) + 1;
localStorage.setItem('totalVisits', totalVisits);

let today = new Date().toDateString();
let lastVisit = localStorage.getItem('lastVisit');
let dailyVisits = localStorage.getItem('dailyVisits') || 0;

if (lastVisit !== today) {
  dailyVisits = 1;
  localStorage.setItem('lastVisit', today);
} else {
  dailyVisits = parseInt(dailyVisits) + 1;
}
localStorage.setItem('dailyVisits', dailyVisits);

document.getElementById('visitorCount').textContent = dailyVisits;
document.getElementById('totalVisits').textContent = totalVisits;

// ==================== TOAST ====================
function showToast(msg) {
  let t = document.getElementById('copyToast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

// ==================== MUSIC ====================
const audio = document.getElementById('bg-music');
const musicIndicator = document.getElementById('musicIndicator');
let musicStarted = false;
audio.volume = 0.15;

function toggleMusic() {
  if (audio.paused) {
    audio.play().then(() => {
      musicStarted = true;
      musicIndicator.innerHTML = 'ğŸ”Š playing';
      musicIndicator.classList.add('playing');
    }).catch(() => {
      musicIndicator.innerHTML = 'âš ï¸ tap again';
    });
  } else {
    audio.pause();
    musicIndicator.innerHTML = 'ğŸ”Š music';
    musicIndicator.classList.remove('playing');
  }
}

// ==================== DISCORD WIDGET ====================
const GUILD_ID = '1441040764506345574';
async function fetchDiscordWidget() {
  try {
    const response = await fetch(`https://discord.com/api/guilds/${GUILD_ID}/widget.json`);
    if (!response.ok) throw new Error('Widget not enabled');
    const data = await response.json();
    document.getElementById('onlineCount').textContent = data.presence_count || 0;
    document.getElementById('discordServerName').textContent = data.name || 'Lokus Hub';
  } catch (error) {
    document.getElementById('onlineCount').textContent = '0';
  }
}

// ==================== REDIRECT MODAL FUNCTIONS ====================
let redirectTimer = null;
const redirectModal = document.getElementById('redirectModal');
const redirectTimerEl = document.getElementById('redirectTimer');
const redirectProgress = document.getElementById('redirectProgress');
let pendingRedirectUrl = null;

function showRedirectModal(url) {
  pendingRedirectUrl = url;
  redirectModal.classList.add('active');
  
  let timeLeft = 5;
  redirectTimerEl.textContent = timeLeft;
  redirectProgress.style.width = '100%';
  
  if (redirectTimer) clearInterval(redirectTimer);
  redirectTimer = setInterval(() => {
    timeLeft--;
    redirectTimerEl.textContent = timeLeft;
    redirectProgress.style.width = (timeLeft / 5) * 100 + '%';
    
    if (timeLeft <= 0) {
      clearInterval(redirectTimer);
      redirectModal.classList.remove('active');
      if (pendingRedirectUrl) {
        window.location.href = pendingRedirectUrl;
      }
    }
  }, 1000);
}

function closeRedirectModal() {
  redirectModal.classList.remove('active');
  if (redirectTimer) {
    clearInterval(redirectTimer);
    redirectTimer = null;
  }
  pendingRedirectUrl = null;
}

function closeRedirectModalIfOverlay(e) {
  if (e.target === redirectModal) {
    closeRedirectModal();
  }
}

// ==================== ADVANCED SEARCH FUNCTIONS ====================
let currentScripts = [];
let filteredScripts = [];

// Apply all filters
function applyFilters() {
  const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
  const gameFilter = document.getElementById('gameFilter').value;
  const keyFilter = document.getElementById('keyFilter').value;
  const featureFilter = document.getElementById('featureFilter').value;
  
  filteredScripts = currentScripts.filter(script => {
    // Skip blurred scripts? (optional - set to true if you want to hide blurred)
    // if (script.blurred) return false;
    
    // Search in name, description, and features
    let matchesSearch = true;
    if (searchTerm) {
      const searchableText = `
        ${script.name.toLowerCase()} 
        ${script.description?.toLowerCase() || ''} 
        ${script.features?.join(' ').toLowerCase() || ''}
      `;
      matchesSearch = searchableText.includes(searchTerm);
    }
    
    // Filter by game (based on name)
    let matchesGame = true;
    if (gameFilter !== 'all') {
      const nameLower = script.name.toLowerCase();
      matchesGame = nameLower.includes(gameFilter) || 
                    (gameFilter === 'mm2' && nameLower.includes('murder')) ||
                    (gameFilter === 'adopt' && nameLower.includes('adopt')) ||
                    (gameFilter === 'bloxfruit' && nameLower.includes('blox'));
    }
    
    // Filter by key system
    let matchesKey = true;
    if (keyFilter !== 'all') {
      matchesKey = script.keySystem === keyFilter;
    }
    
    // Filter by feature
    let matchesFeature = true;
    if (featureFilter !== 'all' && script.features) {
      matchesFeature = script.features.some(f => 
        f.toLowerCase().includes(featureFilter.toLowerCase())
      );
    }
    
    return matchesSearch && matchesGame && matchesKey && matchesFeature;
  });
  
  // Update UI
  updateScriptsDisplay();
  updateSearchStats();
  
  // Show/hide clear button
  document.getElementById('searchClear').style.display = searchTerm ? 'block' : 'none';
}

// Update the display with filtered scripts
function updateScriptsDisplay() {
  const container = document.getElementById('scriptsContainer');
  
  if (filteredScripts.length === 0) {
    container.innerHTML = '<p style="color:#888; text-align:center; grid-column:1/-1; padding:40px;">ğŸ” No scripts match your filters</p>';
    return;
  }
  
  container.innerHTML = '';
  filteredScripts.forEach(script => createScriptCard(script, container));
}

// Create a script card (moved from loadScripts)
function createScriptCard(script, container) {
  const card = document.createElement('div');
  card.className = `script-card ${script.blurred ? 'blurred' : ''}`;
  card.id = script.id + '-card';
  
  if (script.blurred) {
    card.addEventListener('click', function(e) {
      if (e.target.classList.contains('copy-btn')) return;
      
      if (!script.redirectUrl) {
        alert('This script requires verification but no redirect URL is configured.');
        return;
      }
      
      sessionStorage.setItem('bloxlinkRedirect', script.redirectUrl);
      sessionStorage.setItem('bloxlinkScriptId', script.id);
      sessionStorage.setItem('bloxlinkScriptName', script.name);
      showRedirectModal('/bloxlink.html');
    });
  }
  
  let keyBadge = '';
  if (script.keySystem === 'keyless') keyBadge = '<span class="key-badge keyless">ğŸ”“ KEYLESS</span>';
  else if (script.keySystem === 'key1') keyBadge = '<span class="key-badge key1">ğŸ”‘ 1 KEY</span>';
  else if (script.keySystem === 'key2') keyBadge = '<span class="key-badge key2">ğŸ”‘ğŸ”‘ 2 KEYS</span>';
  else if (script.keySystem === 'key3') keyBadge = '<span class="key-badge key3">ğŸ”‘ğŸ”‘ğŸ”‘ 3 KEYS</span>';
  
  let features = '';
  if (script.features?.length) {
    features = '<div class="feature-tags">' + 
      script.features.map(f => `<span class="feature-tag">${f}</span>`).join('') + 
      '</div>';
  }
  
  let icon = script.image ? 
    `<img src="${script.image}" class="script-icon" onerror="this.style.display='none'">` : 
    '<div class="script-icon" style="background:#1a2a2a; display:flex; align-items:center; justify-content:center;">ğŸ“œ</div>';
  
  card.innerHTML = `
    <div class="script-header">
      ${icon}
      <div class="script-title">${script.name}</div>
    </div>
    ${keyBadge}
    ${script.description ? `<div class="script-description">${script.description}</div>` : ''}
    ${features}
    <div class="script-code" id="${script.id}">${script.code.replace(/</g,'&lt;').replace(/>/g,'&gt;')}</div>
    <button class="copy-btn" onclick="copyScript('${script.id}')" ${script.blurred ? 'disabled' : ''}>ğŸ“‹ Copy Script</button>
  `;
  
  container.appendChild(card);
}

// Update search stats
function updateSearchStats() {
  document.getElementById('visibleCount').textContent = filteredScripts.length;
}

// Clear search input
function clearSearch() {
  document.getElementById('searchInput').value = '';
  document.getElementById('searchClear').style.display = 'none';
  applyFilters();
}

// Reset all filters
function resetSearch() {
  document.getElementById('searchInput').value = '';
  document.getElementById('gameFilter').value = 'all';
  document.getElementById('keyFilter').value = 'all';
  document.getElementById('featureFilter').value = 'all';
  document.getElementById('searchClear').style.display = 'none';
  
  // Reset category chips
  document.querySelectorAll('.filter-chip').forEach(chip => chip.classList.remove('active'));
  document.querySelector('[data-filter="all"]').classList.add('active');
  
  filteredScripts = [...currentScripts];
  updateScriptsDisplay();
  updateSearchStats();
}

// Set category filter
function setCategory(category) {
  document.querySelectorAll('.filter-chip').forEach(chip => chip.classList.remove('active'));
  event.target.classList.add('active');
  
  if (category === 'all') {
    resetSearch();
  } else if (category === 'popular') {
    // Sort by downloads (if you have download tracking)
    filteredScripts = [...currentScripts].sort((a, b) => {
      const downloads = JSON.parse(localStorage.getItem('downloads') || '{}');
      return (downloads[b.id] || 0) - (downloads[a.id] || 0);
    });
    updateScriptsDisplay();
    updateSearchStats();
  } else if (category === 'new') {
    // Sort by newest (assuming IDs contain timestamps)
    filteredScripts = [...currentScripts].sort((a, b) => b.id.localeCompare(a.id));
    updateScriptsDisplay();
    updateSearchStats();
  } else {
    // Filter by game
    document.getElementById('gameFilter').value = category;
    applyFilters();
  }
}

// ==================== LOAD THEME & SCRIPTS ====================
async function loadScripts() {
  try {
    const response = await fetch('scripts.json?t=' + Date.now());
    const data = await response.json();
    
    // Apply theme
    if (data.theme) {
      document.body.className = data.theme;
    }
    
    // Show latest version
    if (data.versions && data.versions.length > 0) {
      const latest = data.versions[0];
      document.getElementById('versionDisplay').innerHTML = 
        `<span class="version-badge">v${latest.version}</span> <span style="color:#888;">${latest.date}</span>`;
    }
    
    currentScripts = data.scripts || [];
    filteredScripts = [...currentScripts];
    
    document.getElementById('totalCount').textContent = currentScripts.length;
    updateScriptsDisplay();
    updateSearchStats();
    
  } catch (e) {
    console.error('Failed to load scripts:', e);
    document.getElementById('scriptsContainer').innerHTML = '<p style="color:#ff4444; text-align:center;">Failed to load scripts</p>';
  }
}

// ==================== COPY ====================
function copyScript(id) {
  const el = document.getElementById(id);
  if (!el) return;
  
  const card = document.getElementById(id + '-card');
  if (card && card.classList.contains('blurred')) {
    showToast('ğŸ”’ Verify first to copy!');
    return;
  }
  
  navigator.clipboard.writeText(el.textContent).then(() => {
    showToast('âœ… Script copied!');
    
    // Track download
    let downloads = JSON.parse(localStorage.getItem('downloads') || '{}');
    downloads[id] = (downloads[id] || 0) + 1;
    localStorage.setItem('downloads', JSON.stringify(downloads));
    
  }).catch(() => {
    alert('Copy manually: ' + el.textContent);
  });
}

// ==================== EVENT LISTENERS ====================
document.getElementById('searchInput').addEventListener('input', applyFilters);
document.addEventListener('keydown', (e) => {
  if (e.ctrlKey && e.key === 'f') {
    e.preventDefault();
    document.getElementById('searchInput').focus();
  }
});

// ==================== INIT ====================
window.addEventListener('load', () => {
  loadScripts();
  fetchDiscordWidget();
  setInterval(fetchDiscordWidget, 60000);
  
  // Clear any old session data
  sessionStorage.removeItem('bloxlinkRedirect');
  sessionStorage.removeItem('bloxlinkScriptId');
  sessionStorage.removeItem('bloxlinkScriptName');
});

// Reload scripts every 5 minutes
setInterval(() => {
  console.log('ğŸ”„ Checking for script updates...');
  loadScripts();
}, 300000);
</script></body></html>
